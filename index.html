<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ultimate Spanish SPA: Reflexivos vs. Rec√≠procos üöÄ</title>
    <style>
        /* =========================================
           1. ESTILO BASE (Golden Format)
           ========================================= */
        :root {
            --primary: #007bff;
            --dark-blue: #0056b3;
            --green: #28a745;
            --red: #dc3545;
            --yellow: #ffc107;
            --orange: #fd7e14;
            --purple: #6f42c1;
            
            --bg-color: #f0f4f8;
            --container-bg: #ffffff;
            --text-color: #333;
            --header-bg: linear-gradient(135deg, var(--primary), var(--dark-blue));
            --tab-bg: #f1f1f1;
            --tab-active-bg: var(--primary);
            --tab-text: #555;
            --tab-active-text: #ffffff;
            --border-color: #dee2e6;
            --light-gray-bg: #f8f9fa;
            --shadow: 0 4px 15px rgba(0,0,0,0.1);
            --card-hover: 0 10px 25px rgba(0,0,0,0.15);
        }

        body.dark-mode {
            --bg-color: #121212;
            --container-bg: #1e1e1e;
            --text-color: #e0e0e0;
            --header-bg: #2c2c2c;
            --tab-bg: #333;
            --tab-active-bg: #bb86fc;
            --tab-text: #aaa;
            --tab-active-text: #000;
            --border-color: #444;
            --light-gray-bg: #2c2c2c;
            --shadow: 0 4px 15px rgba(0,0,0,0.5);
        }

        * { box-sizing: border-box; transition: background-color 0.3s, color 0.3s; }
        body { font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: var(--bg-color); color: var(--text-color); margin: 0; padding: 15px; min-height: 100vh; }
        
        .main-container { max-width: 1000px; margin: 0 auto; background: var(--container-bg); border-radius: 20px; box-shadow: var(--shadow); overflow: hidden; position: relative; z-index: 10; }

        /* HEADER */
        header { background: var(--header-bg); color: white; padding: 30px 20px; text-align: center; position: relative; }
        header h1 { margin: 10px 0 5px; font-size: 2rem; text-shadow: 1px 1px 3px rgba(0,0,0,0.3); }
        .top-btn { position: absolute; top: 15px; background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.4); color: white; padding: 5px 10px; border-radius: 15px; cursor: pointer; font-size: 0.9rem; font-weight: bold; backdrop-filter: blur(4px); }
        .lang-btn { left: 15px; }
        .theme-btn { right: 15px; }

        /* TABS */
        .tab-nav { display: flex; background: var(--tab-bg); overflow-x: auto; border-bottom: 1px solid var(--border-color); }
        .tab-btn { flex: 1; padding: 15px 10px; border: none; background: none; cursor: pointer; font-size: 0.9rem; color: var(--tab-text); border-bottom: 4px solid transparent; font-weight: 700; white-space: nowrap; min-width: 80px; }
        .tab-btn.active { background: var(--tab-active-bg); color: var(--tab-active-text); border-bottom-color: var(--yellow); }
        .tab-content { display: none; padding: 25px; animation: fadeIn 0.4s; }
        .tab-content.active { display: block; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }

        /* =========================================
           2. ESTILOS POR PESTA√ëA
           ========================================= */
        
        /* TAB 1: CONCEPT */
        .metaphor-grid { display: flex; gap: 15px; flex-wrap: wrap; margin-bottom: 30px; }
        .metaphor-card { flex: 1; min-width: 250px; background: var(--container-bg); border: 2px solid var(--border-color); border-radius: 15px; padding: 20px; text-align: center; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .big-icon { font-size: 3rem; display: block; margin-bottom: 10px; }
        
        .video-grid { display: grid; grid-template-columns: 1fr; gap: 20px; margin: 30px 0; }
        @media (min-width: 700px) { .video-grid { grid-template-columns: 1fr 1fr; } }
        .video-container { position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); background: #000; }
        .video-container iframe { position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none; }
        
        .formula-visualizer { background: var(--container-bg); padding: 25px; border-radius: 15px; border: 2px solid var(--primary); margin-top: 30px; text-align: center; box-shadow: var(--shadow); }
        .visualizer-display { font-size: 1.4rem; margin: 25px 0; padding: 20px; background: var(--light-gray-bg); border-radius: 10px; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; align-items: center; min-height: 80px; }
        .vis-part { padding: 10px 15px; border-radius: 8px; cursor: default; transition: all 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .vis-subject { background: #e3f2fd; color: var(--primary); border: 1px solid #b3d7ff; font-weight: bold; }
        .vis-pronoun { background: #fff3cd; color: #856404; font-weight: bold; border: 1px solid #ffeeba; transform: scale(1.1); box-shadow: 0 4px 8px rgba(0,0,0,0.15); z-index: 2; }
        .vis-verb { background: #d4edda; color: #155724; border: 1px solid #c3e6cb; }
        .vis-clarifier { background: #f8d7da; color: #721c24; border: 1px solid #f5c6cb; font-style: italic; }
        .vis-controls { display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; margin-top: 20px; }

        /* TAB 2: FORMULA */
        .formula-box { background: var(--dark-blue); color: white; padding: 20px; border-radius: 15px; text-align: center; margin: 20px 0; }
        .formula-parts { display: flex; justify-content: center; gap: 5px; flex-wrap: wrap; margin-top: 10px; }
        .f-part { padding: 8px 12px; border-radius: 8px; font-weight: bold; }
        .fp-subj { background: #4dabf7; color: #000; }
        .fp-pron { background: var(--yellow); color: #000; transform: scale(1.1); box-shadow: 0 0 10px rgba(255,255,255,0.5); }
        .fp-verb { background: var(--green); color: white; }
        .tip-box { background: #fff3cd; color: #856404; padding: 15px; border-left: 5px solid var(--yellow); margin-top: 20px; border-radius: 5px; }

        /* TAB 3: PHRASES */
        .phrases-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); gap: 20px; }
        .phrase-card { background: var(--container-bg); border-radius: 15px; padding: 20px; box-shadow: 0 4px 10px rgba(0,0,0,0.08); border-left: 5px solid var(--primary); display: flex; flex-direction: column; gap: 10px; transition: transform 0.2s; position: relative; }
        .phrase-card:hover { transform: translateY(-3px); box-shadow: var(--card-hover); }
        .phrase-card.reciprocal { border-left-color: var(--green); }
        .phrase-card.reflexive { border-left-color: var(--orange); }
        .p-icon { font-size: 2rem; align-self: center; margin-bottom: 5px; }
        .p-text { font-size: 1.1rem; font-weight: bold; text-align: center; }
        .p-btn { margin-top: auto; background: var(--light-gray-bg); border: none; padding: 8px; border-radius: 8px; cursor: pointer; color: var(--primary); font-weight: bold; }

        /* MODAL */
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.6); display: none; justify-content: center; align-items: center; z-index: 100; backdrop-filter: blur(5px); }
        .modal-content { background: var(--container-bg); padding: 30px; border-radius: 15px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto; border: 4px solid var(--dark-blue); box-shadow: 0 20px 50px rgba(0,0,0,0.3); }
        .modal-header { font-family: 'Courier New', monospace; font-weight: bold; color: var(--dark-blue); font-size: 1.5rem; border-bottom: 2px dashed #ccc; padding-bottom: 10px; margin-bottom: 15px; }
        .modal-explanation { font-size: 1.1rem; line-height: 1.6; }

        /* TAB 4: DETECTOR GPS */
        .gps-box { background: #ffffff; padding: 30px; border-radius: 25px; text-align: center; border: none; box-shadow: 0 10px 40px rgba(0,0,0,0.1); max-width: 800px; margin: 0 auto; }
        .gps-step { display: none; animation: slideIn 0.4s ease-out; }
        .gps-step.active { display: block; }
        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .gps-question-title { font-size: 1.8rem; color: var(--dark-blue); margin-bottom: 30px; }
        .gps-options-grid { display: flex; justify-content: center; gap: 20px; flex-wrap: wrap; }
        .gps-card-btn { background: var(--light-gray-bg); border: 3px solid transparent; border-radius: 20px; padding: 25px; cursor: pointer; transition: all 0.3s; flex: 1; min-width: 200px; max-width: 300px; display: flex; flex-direction: column; align-items: center; gap: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); }
        .gps-card-btn:hover { transform: translateY(-8px) scale(1.02); box-shadow: 0 15px 30px rgba(0,0,0,0.15); border-color: var(--primary); }
        .gps-icon-big { font-size: 4rem; display: block; filter: drop-shadow(0 4px 2px rgba(0,0,0,0.1)); }
        .gps-text { font-size: 1.1rem; font-weight: bold; color: var(--text-color); }
        .result-badge { padding: 40px; border-radius: 20px; color: white; margin-top: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.2); animation: popIn 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
        @keyframes popIn { from { transform: scale(0.8); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .res-green { background: linear-gradient(135deg, #28a745, #218838); }
        .res-orange { background: linear-gradient(135deg, #fd7e14, #e67e22); }
        .res-icon { font-size: 5rem; display: block; margin-bottom: 10px; }
        .btn-yes:hover { border-color: var(--green); background: #e8f5e9; }
        .btn-no:hover { border-color: var(--orange); background: #fff3e0; }

        /* TAB 5 & 6: PRACTICE & FLASHCARDS */
        .quiz-container { margin-bottom: 30px; }
        .quiz-question { background: var(--container-bg); padding: 15px; border-radius: 10px; margin-bottom: 15px; border-left: 4px solid var(--purple); box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        .quiz-options button { display: block; width: 100%; padding: 10px; margin: 5px 0; border: 1px solid var(--border-color); border-radius: 8px; background: var(--bg-color); cursor: pointer; text-align: left; }
        .quiz-options button:hover { background: #e9ecef; }
        .quiz-options button.correct { background: #d4edda; border-color: var(--green); }
        .quiz-options button.wrong { background: #f8d7da; border-color: var(--red); }
        .story-container { background: #fffcf5; padding: 20px; border-radius: 10px; margin-bottom: 20px; border: 1px solid #e0d0b0; line-height: 1.8; }
        body.dark-mode .story-container { background: #2a2a2a; border-color: #444; }
        select.story-input { border: none; border-bottom: 2px solid var(--primary); background: transparent; color: var(--text-color); font-weight: bold; padding: 0 5px; cursor: pointer; }
        .sorter-area { display: flex; gap: 15px; flex-wrap: wrap; margin-top: 20px; }
        .drop-zone { flex: 1; min-width: 250px; min-height: 300px; background: rgba(0,0,0,0.03); border: 2px dashed #aaa; border-radius: 15px; padding: 15px; }
        .draggable-source { display: flex; flex-wrap: wrap; gap: 8px; padding: 15px; background: var(--light-gray-bg); border-radius: 15px; min-height: 80px; margin-bottom: 15px; }
        .drag-item { background: white; padding: 8px 15px; border-radius: 20px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); cursor: grab; font-size: 0.9rem; border: 1px solid var(--border-color); }
        .fc-scene { perspective: 1000px; width: 100%; max-width: 500px; height: 300px; margin: 20px auto; cursor: pointer; }
        .fc-card { width: 100%; height: 100%; position: relative; transition: transform 0.6s; transform-style: preserve-3d; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.15); }
        .fc-card.is-flipped { transform: rotateY(180deg); }
        .fc-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; display: flex; flex-direction: column; justify-content: center; align-items: center; border-radius: 20px; padding: 20px; background: var(--container-bg); border: 1px solid var(--border-color); }
        .fc-back { transform: rotateY(180deg); background: var(--light-gray-bg); border-color: var(--primary); }
        .tts-btn { font-size: 1.5rem; background: none; border: none; cursor: pointer; margin-top: 15px; }

        /* UTILS */
        .btn { background: var(--primary); color: white; border: none; padding: 10px 20px; border-radius: 50px; cursor: pointer; font-weight: bold; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        .btn:hover { transform: translateY(-2px); }
        .hidden { display: none; }
        #floating-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; pointer-events: none; z-index: -1; overflow: hidden; }
        .floater { position: absolute; font-size: 2.5rem; opacity: 0.15; animation: floatUp 25s linear infinite; }
        @keyframes floatUp { 0% { transform: translateY(110vh) rotate(0deg); opacity: 0; } 10% { opacity: 0.2; } 100% { transform: translateY(-10vh) rotate(360deg); opacity: 0; } }
    </style>
</head>
<body>

    <div id="floating-bg"></div>

    <div class="main-container">
        <header>
            <h1 data-key="title">Master de Reciprocidad ü§ù</h1>
            <p data-key="subtitle">La gu√≠a definitiva: Reflexivos vs. Rec√≠procos</p>
            <button class="top-btn lang-btn" onclick="toggleLang()">üåê ES/EN</button>
            <button class="top-btn theme-btn" onclick="toggleTheme()">üåì</button>
        </header>

        <nav class="tab-nav">
            <button class="tab-btn active" onclick="switchTab('concept')" data-key="tab_concept">Concepto</button>
            <button class="tab-btn" onclick="switchTab('formula')" data-key="tab_formula">F√≥rmula</button>
            <button class="tab-btn" onclick="switchTab('phrases')" data-key="tab_phrases">Frases</button>
            <button class="tab-btn" onclick="switchTab('detector')" data-key="tab_detector">Detector</button>
            <button class="tab-btn" onclick="switchTab('practice')" data-key="tab_practice">Pr√°ctica</button>
            <button class="tab-btn" onclick="switchTab('flashcards')" data-key="tab_flashcards">Flashcards</button>
        </nav>

        <div id="concept" class="tab-content active">
            <h2 data-key="h_metaphor">La Met√°fora Visual</h2>
            <div class="metaphor-grid">
                <div class="metaphor-card">
                    <span class="big-icon">ü™û</span>
                    <h3 data-key="reflexive">Reflexivo</h3>
                    <p data-key="ref_desc">La acci√≥n vuelve a m√≠ mismo. Como un boomerang.</p>
                </div>
                <div class="metaphor-card">
                    <span class="big-icon">ü§ù</span>
                    <h3 data-key="reciprocal">Rec√≠proco</h3>
                    <p data-key="rec_desc">La acci√≥n se cruza entre dos o m√°s personas.</p>
                </div>
            </div>

            <h2 data-key="h_video">Tutoriales Interactivos</h2>
            <div class="video-grid">
                <div class="video-container">
                    <iframe src="https://drive.google.com/file/d/12cKfeZBdHd4G0c0GPtGyQ544XCByU5Ao/preview" allow="autoplay"></iframe>
                </div>
                <div class="video-container">
                    <iframe src="https://drive.google.com/file/d/1oMwE-UomsYfJe6LGIH7SZeku4Amfy8Is/preview" allow="autoplay"></iframe>
                </div>
            </div>

            <div class="formula-visualizer">
                <h3 style="color: var(--primary); margin-top: 0;" data-key="vis_title">üßô‚Äç‚ôÇÔ∏è Creador de Reciprocidad</h3>
                <p data-key="vis_desc">Haz clic en los botones para construir situaciones rec√≠procas.</p>
                <div class="visualizer-display">
                    <span id="vis-subj" class="vis-part vis-subject">Ana y Luis üë©‚Äç‚ù§Ô∏è‚Äçüë®</span>
                    <span id="vis-pron" class="vis-part vis-pronoun">+ SE +</span>
                    <span id="vis-verb" class="vis-part vis-verb">abrazan ü§ó</span>
                    <span id="vis-clar" class="vis-part vis-clarifier">(el uno al otro)</span>
                </div>
                <div class="vis-controls">
                    <p style="width: 100%; margin-bottom: 10px;"><strong data-key="vis_choose">Elige el Sujeto:</strong></p>
                    <button class="btn" style="background:var(--primary)" onclick="updateVisualizer('nosotros')" data-key="vis_btn_we">Nosotros üë•</button>
                    <button class="btn" style="background:var(--primary)" onclick="updateVisualizer('vosotros')" data-key="vis_btn_you_pl">Vosotros ü´µ</button>
                    <button class="btn" style="background:var(--primary)" onclick="updateVisualizer('ellos')" data-key="vis_btn_they">Ellos/Ustedes üåç</button>
                </div>
            </div>
        </div>

        <div id="formula" class="tab-content">
            <h2 data-key="h_formula">La Estructura Gramatical</h2>
            <div class="formula-box">
                <p data-key="formula_rule">El pronombre siempre va ANTES del verbo conjugado.</p>
                <div class="formula-parts">
                    <div class="f-part fp-subj" data-key="fp_subj">SUJETO (A+B)</div>
                    <div class="f-part fp-pron" data-key="fp_pron">PRONOMBRE (Nos/Os/Se)</div>
                    <div class="f-part fp-verb" data-key="fp_verb">VERBO (Plural)</div>
                </div>
                <p style="margin-top:15px; font-size:1.2rem;">"Ana y yo <b>nos</b> abrazamos."</p>
            </div>

            <div class="tip-box">
                <h3 data-key="tip_title">üí° El Truco Maestro</h3>
                <p data-key="tip_desc">Para saber si es REC√çPROCO, intenta a√±adir al final: <b>"el uno al otro"</b> (o "mutuamente"). Si tiene sentido, ¬°es rec√≠proco!</p>
                <button class="btn" onclick="speakPremium('el uno al otro')" style="margin-top:10px" data-key="hear_trick">üîä Escuchar Truco</button>
            </div>
        </div>

        <div id="phrases" class="tab-content">
            <h2 data-key="h_examples">Ejemplos Clave</h2>
            <p style="margin-bottom:20px; text-align:center" data-key="phrases_sub">Haz clic en 'Explicar' para ver detalles.</p>
            <div class="phrases-grid" id="phrases-container"></div>
        </div>

        <div id="detector" class="tab-content">
            <h2 data-key="h_detector">El Detector GPS üïµÔ∏è</h2>
            <div class="gps-box">
                <div id="gps-step-1" class="gps-step active">
                    <h3 class="gps-question-title" data-key="gps_q1">¬øCu√°ntas personas realizan la acci√≥n?</h3>
                    <div class="gps-options-grid">
                        <button class="gps-card-btn" onclick="gpsNext(1, 'one')">
                            <span class="gps-icon-big">üë§</span>
                            <span class="gps-text" data-key="gps_opt_one">Solo una persona<br><small>(Yo, √âl, Ella...)</small></span>
                        </button>
                        <button class="gps-card-btn" onclick="gpsNext(1, 'many')">
                            <span class="gps-icon-big">üë•</span>
                            <span class="gps-text" data-key="gps_opt_many">Dos o m√°s personas<br><small>(Nosotros, Ellos...)</small></span>
                        </button>
                    </div>
                </div>
                
                <div id="gps-step-2a" class="gps-step">
                    <div class="result-badge res-orange">
                        <span class="res-icon">ü™û</span>
                        <h3 style="font-size:2rem; margin:0;" data-key="gps_res_ref">¬°Es REFLEXIVO!</h3>
                    </div>
                    <p style="font-size:1.2rem; margin-top:20px; line-height:1.6;" data-key="gps_exp_ref">Una sola persona no puede hacer algo rec√≠proco.<br><b>La acci√≥n rebota como un boomerang.</b></p>
                    <button class="btn" onclick="gpsReset()" data-key="reset" style="margin-top:20px; padding:12px 30px;">üîÑ Reiniciar</button>
                </div>

                <div id="gps-step-2b" class="gps-step">
                    <h3 class="gps-question-title" data-key="gps_q2">Prueba m√°gica: ¬øPuedes decir "el uno al otro"?</h3>
                    <p style="font-size:1.1rem; color:#666; margin-bottom:30px;" data-key="gps_q2_sub">(Ejemplo: "Ellos se miran... ¬øel uno al otro?")</p>
                    <div class="gps-options-grid">
                        <button class="gps-card-btn btn-yes" onclick="gpsNext(2, 'yes')">
                            <span class="gps-icon-big">‚úÖ</span>
                            <span class="gps-text" data-key="yes">S√ç, tiene sentido.<br>(Es mutuo)</span>
                        </button>
                        <button class="gps-card-btn btn-no" onclick="gpsNext(2, 'no')">
                            <span class="gps-icon-big">‚ùå</span>
                            <span class="gps-text" data-key="no">NO, suena raro.<br>(Cada uno a s√≠ mismo)</span>
                        </button>
                    </div>
                </div>

                <div id="gps-result-rec" class="gps-step">
                    <div class="result-badge res-green">
                        <span class="res-icon">ü§ù</span>
                        <h3 style="font-size:2rem; margin:0;" data-key="res_rec">¬°Es REC√çPROCO!</h3>
                    </div>
                    <p style="font-size:1.2rem; margin-top:20px;" data-key="res_rec_desc">La acci√≥n cruza de A a B y de B a A.</p>
                    <button class="btn" onclick="gpsReset()" data-key="reset_anal" style="margin-top:20px;">üîÑ Analizar otra frase</button>
                </div>
                
                <div id="gps-result-refpl" class="gps-step">
                    <div class="result-badge res-orange">
                        <span class="res-icon">ü™ûüë•</span>
                        <h3 style="font-size:2rem; margin:0;" data-key="res_ref_pl">¬°Es REFLEXIVO (Plural)!</h3>
                    </div>
                    <p style="font-size:1.2rem; margin-top:20px;" data-key="res_ref_pl_desc">Son varios, pero cada uno realiza la acci√≥n sobre s√≠ mismo.</p>
                    <button class="btn" onclick="gpsReset()" data-key="reset_anal" style="margin-top:20px;">üîÑ Analizar otra frase</button>
                </div>
            </div>
        </div>

        <div id="practice" class="tab-content">
            <h2 data-key="h_quiz">Parte 1: Quiz R√°pido</h2>
            <div id="quiz-area" class="quiz-container"></div>
            <p id="quiz-score" style="text-align:center; font-weight:bold;"></p>

            <h2 data-key="h_stories">Parte 2: Completa las Historias</h2>
            <div id="stories-area"></div>
            <button class="btn" onclick="checkStories()" data-key="check_stories">Comprobar Historias</button>

            <h2 data-key="h_sorter" style="margin-top:40px;">Parte 3: Clasificador</h2>
            <div class="draggable-source" id="sorter-source"></div>
            <div class="sorter-area">
                <div class="drop-zone" id="drop-reflex" ondragover="allowDrop(event)" ondrop="drop(event)" style="border-color:var(--orange)">
                    <h3 style="color:var(--orange)" data-key="reflexive">Reflexivo ü™û</h3>
                </div>
                <div class="drop-zone" id="drop-recip" ondragover="allowDrop(event)" ondrop="drop(event)" style="border-color:var(--green)">
                    <h3 style="color:var(--green)" data-key="reciprocal">Rec√≠proco ü§ù</h3>
                </div>
            </div>
            <button class="btn" onclick="checkSorter()" style="margin-top:15px; width:100%" data-key="check_sort">Comprobar Clasificaci√≥n</button>
        </div>

        <div id="flashcards" class="tab-content">
            <h2 data-key="h_flashcards">Tarjetas de Pr√°ctica</h2>
            <div class="fc-scene" onclick="flipFlashcard()">
                <div class="fc-card" id="fc-card-el">
                    <div class="fc-face">
                        <h3 id="fc-front-text" style="color:#333">...</h3>
                        <p style="color:#777; margin-top:20px" data-key="tap_flip">(Toca para girar)</p>
                    </div>
                    <div class="fc-face fc-back">
                        <h3 id="fc-back-text" style="color:var(--primary)">...</h3>
                        <button class="tts-btn" onclick="event.stopPropagation(); playCurrentCardAudio()">üîä</button>
                    </div>
                </div>
            </div>
            <div style="text-align:center; margin-top:20px; display:flex; justify-content:center; gap:20px; align-items:center;">
                <button class="btn" onclick="prevFC()">‚¨ÖÔ∏è</button>
                <span id="fc-count" style="font-weight:bold">1/20</span>
                <button class="btn" onclick="nextFC()">‚û°Ô∏è</button>
            </div>
        </div>

    </div>

    <div id="modal-global" class="modal-overlay" onclick="closeModal(event)">
        <div class="modal-content">
            <div class="modal-header" id="m-header">DETALLES</div>
            <div class="modal-explanation" id="m-body">...</div>
            <button class="btn" onclick="document.getElementById('modal-global').style.display='none'" style="margin-top:20px; width:100%" data-key="close">Cerrar</button>
        </div>
    </div>

    <script>
        /* =========================================
           DATA & TRANSLATIONS
           ========================================= */
        const langData = {
            es: {
                title: "Master de Reciprocidad ü§ù", subtitle: "La gu√≠a definitiva: Reflexivos vs. Rec√≠procos", tab_concept: "Concepto", tab_formula: "F√≥rmula",
                tab_phrases: "Frases", tab_detector: "Detector", tab_practice: "Pr√°ctica", tab_flashcards: "Flashcards",
                h_metaphor: "La Met√°fora Visual", reflexive: "Reflexivo", reciprocal: "Rec√≠proco", ambiguous: "Ambiguo",
                ref_desc: "La acci√≥n vuelve a m√≠ mismo. Como un boomerang.", rec_desc: "La acci√≥n se cruza entre dos o m√°s personas.",
                h_video: "Tutoriales Interactivos", 
                vis_title: "üßô‚Äç‚ôÇÔ∏è Creador de Reciprocidad", vis_desc: "Haz clic en los botones para construir situaciones rec√≠procas.", vis_choose: "Elige el Sujeto:",
                vis_btn_we: "Nosotros üë•", vis_btn_you_pl: "Vosotros ü´µ", vis_btn_they: "Ellos/Ustedes üåç",
                h_formula: "La Estructura Gramatical", formula_rule: "El pronombre siempre va ANTES del verbo conjugado.", 
                fp_subj: "SUJETO (A+B)", fp_pron: "PRONOMBRE (Nos/Os/Se)", fp_verb: "VERBO (Plural)",
                tip_title: "üí° El Truco Maestro", tip_desc: "Para saber si es REC√çPROCO, intenta a√±adir al final: <b>'el uno al otro'</b> (o 'mutuamente'). Si tiene sentido, ¬°es rec√≠proco!", hear_trick: "üîä Escuchar Truco",
                h_examples: "Ejemplos Clave", phrases_sub: "Haz clic en 'Explicar' para ver detalles.", 
                
                // --- DETECTOR GPS ---
                h_detector: "El Detector GPS üïµÔ∏è", gps_q1: "¬øCu√°ntas personas realizan la acci√≥n?",
                gps_opt_one: "Solo una persona<br><small>(Yo, √âl, Ella...)</small>", 
                gps_opt_many: "Dos o m√°s personas<br><small>(Nosotros, Ellos...)</small>",
                gps_res_ref: "¬°Es REFLEXIVO! ü™û", 
                gps_exp_ref: "Una sola persona no puede hacer algo rec√≠proco.<br><b>La acci√≥n rebota como un boomerang.</b>",
                reset: "üîÑ Reiniciar",
                gps_q2: "Prueba m√°gica: ¬øPuedes decir 'el uno al otro'?", 
                gps_q2_sub: "(Ejemplo: 'Ellos se miran... ¬øel uno al otro?')",
                yes: "S√ç, tiene sentido.<br>(Es mutuo)", 
                no: "NO, suena raro.<br>(Cada uno a s√≠ mismo)",
                res_rec: "¬°Es REC√çPROCO! ü§ù", 
                res_rec_desc: "La acci√≥n cruza de A a B y de B a A.",
                res_ref_pl: "¬°Es REFLEXIVO (Plural)! ü™û",
                res_ref_pl_desc: "Son varios, pero cada uno realiza la acci√≥n sobre s√≠ mismo.",
                reset_anal: "üîÑ Analizar otra frase",
                
                h_quiz: "Parte 1: Quiz R√°pido", h_stories: "Parte 2: Historias", check_stories: "Comprobar Historias",
                h_sorter: "Parte 3: Clasificador", check_sort: "Comprobar Clasificaci√≥n",
                h_flashcards: "Tarjetas de Pr√°ctica", tap_flip: "(Toca para girar)", close: "Cerrar", explain: "Explicar",
                trans_label: "Traducci√≥n:", type_label: "Tipo:"
            },
            en: {
                title: "Reciprocity Master ü§ù", subtitle: "The Ultimate Guide: Reflexive vs. Reciprocal", tab_concept: "Concept", tab_formula: "Formula",
                tab_phrases: "Phrases", tab_detector: "Detector", tab_practice: "Practice", tab_flashcards: "Flashcards",
                h_metaphor: "Visual Metaphor", reflexive: "Reflexive", reciprocal: "Reciprocal", ambiguous: "Ambiguous",
                ref_desc: "Action returns to self. Like a boomerang.", rec_desc: "Action crosses between two or more people.",
                h_video: "Interactive Tutorials", 
                vis_title: "üßô‚Äç‚ôÇÔ∏è Reciprocity Builder", vis_desc: "Click buttons to build reciprocal situations.", vis_choose: "Choose Subject:",
                vis_btn_we: "We üë•", vis_btn_you_pl: "You (Plural) ü´µ", vis_btn_they: "They üåç",
                h_formula: "Grammar Structure", formula_rule: "Pronoun always goes BEFORE conjugated verb.", 
                fp_subj: "SUBJECT (A+B)", fp_pron: "PRONOUN (Nos/Os/Se)", fp_verb: "VERB (Plural)",
                tip_title: "üí° The Magic Trick", tip_desc: "To know if it's RECIPROCAL, try adding: <b>'each other'</b>. If it makes sense, it's reciprocal!", hear_trick: "üîä Hear Trick",
                h_examples: "Key Examples", phrases_sub: "Click 'Explain' for details.", 
                
                // --- DETECTOR GPS ---
                h_detector: "GPS Detector üïµÔ∏è", gps_q1: "How many people are acting?",
                gps_opt_one: "Only one person<br><small>(Me, He, She...)</small>", 
                gps_opt_many: "Two or more people<br><small>(We, They...)</small>", 
                gps_res_ref: "It's Reflexive! ü™û", 
                gps_exp_ref: "One person cannot be reciprocal.<br><b>Action returns like a boomerang.</b>",
                reset: "üîÑ Reset",
                gps_q2: "Magic Test: Can you say 'each other'?", 
                gps_q2_sub: "(Example: 'They look at... each other?')", 
                yes: "YES, makes sense.<br>(It's mutual)", 
                no: "NO, sounds weird.<br>(Each to themselves)", 
                res_rec: "It's RECIPROCAL! ü§ù", 
                res_rec_desc: "Action crosses from A to B and B to A.",
                res_ref_pl: "REFLEXIVE (Plural)! ü™û",
                res_ref_pl_desc: "Multiple people, but each acts on themselves.",
                reset_anal: "üîÑ Analyze another",
                
                h_quiz: "Part 1: Quick Quiz", h_stories: "Part 2: Stories", check_stories: "Check Stories",
                h_sorter: "Part 3: Sorter", check_sort: "Check Classification",
                h_flashcards: "Practice Cards", tap_flip: "(Tap to flip)", close: "Close", explain: "Explain",
                trans_label: "Translation:", type_label: "Type:"
            }
        };

        let currentLang = 'es';
        let currentPhraseIndex = null; // NUEVO: Para saber qu√© modal est√° abierto

        // --- AUDIO SYSTEM ---
        function speakPremium(text) {
            window.speechSynthesis.cancel();
            let cleanText = text.replace(/([\u2700-\u27BF]|[\uE000-\uF8FF]|\uD83C[\uDC00-\uDFFF]|\uD83D[\uDC00-\uDFFF]|[\u2011-\u26FF]|\uD83E[\uDD10-\uDDFF])/g, '');
            cleanText = cleanText.replace(/_+/g, ','); 
            const utterance = new SpeechSynthesisUtterance(cleanText);
            utterance.lang = 'es-ES';
            const voices = window.speechSynthesis.getVoices();
            const premiumVoice = voices.find(v => (v.name.includes('Google') || v.name.includes('Microsoft')) && v.lang.includes('es')) || voices.find(v => v.lang.includes('es'));
            if(premiumVoice) utterance.voice = premiumVoice;
            utterance.rate = 0.9;
            window.speechSynthesis.speak(utterance);
        }

        // --- CONTENT DATA (ACTUALIZADO CON detail_en) ---
        const phrasesData = [
            { 
                es: "Nos abrazamos", en: "We hug each other", type: "reciprocal", icon: "ü´Ç", 
                detail: "Verbo: Abrazar. Sujeto: Nosotros. Al ser 'nosotros', la acci√≥n es mutua. A abraza a B y B abraza a A.",
                detail_en: "Verb: To Hug. Subject: We. Since it is 'us', the action is mutual. A hugs B and B hugs A."
            },
            { 
                es: "Me lavo las manos", en: "I wash my hands", type: "reflexive", icon: "üßº", 
                detail: "Verbo: Lavar. Sujeto: Yo. La acci√≥n no sale a otra persona, vuelve a mi propio cuerpo.",
                detail_en: "Verb: To Wash. Subject: I. The action does not go to another person, it returns to my own body."
            },
            { 
                es: "Se besan", en: "They kiss each other", type: "reciprocal", icon: "üíã", 
                detail: "Verbo: Besar. Sujeto: Ellos. Contexto rom√°ntico mutuo.",
                detail_en: "Verb: To Kiss. Subject: They. Mutual romantic context."
            },
            { 
                es: "Te peinas", en: "You comb your hair", type: "reflexive", icon: "ü™Æ", 
                detail: "Acci√≥n de cuidado personal (Grooming) suele ser reflexiva.",
                detail_en: "Personal care action (Grooming) is usually reflexive."
            },
            { 
                es: "Se escriben", en: "They write to each other", type: "reciprocal", icon: "‚úâÔ∏è", 
                detail: "Comunicaci√≥n bidireccional. √âl escribe a ella, ella escribe a √©l.",
                detail_en: "Two-way communication. He writes to her, she writes to him."
            },
            { 
                es: "Nos miramos", en: "We look at ourselves/each other", type: "ambiguous", icon: "üëÄ", 
                detail: "¬°Cuidado! Puede ser 'nos miramos al espejo' (Reflexivo) o 'nos miramos a los ojos' (Rec√≠proco). El contexto manda.",
                detail_en: "Careful! It could be 'we look at ourselves in the mirror' (Reflexive) or 'we look into each other's eyes' (Reciprocal). Context rules."
            }
        ];

        const quizData = [
            { q: "Juan y Mar√≠a ___ miran a los ojos.", correct: "se", opts: ["se", "nos", "te"] },
            { q: "Yo ___ ducho cada ma√±ana.", correct: "me", opts: ["me", "se", "nos"] },
            { q: "¬øVosotros ___ conoc√©is bien?", correct: "os", opts: ["os", "se", "nos"] },
            { q: "Mis padres ___ aman mucho.", correct: "se", opts: ["se", "me", "te"] },
            { q: "T√∫ ___ cepillas los dientes.", correct: "te", opts: ["te", "se", "os"] },
            { q: "Nosotros ___ respetamos.", correct: "nos", opts: ["nos", "se", "me"] },
            { q: "Ellas ___ maquillan antes de salir.", correct: "se", opts: ["se", "nos", "os"] },
            { q: "Pedro y yo ___ saludamos.", correct: "nos", opts: ["nos", "se", "os"] },
            { q: "¬øUstedes ___ ven a menudo?", correct: "se", opts: ["se", "nos", "os"] },
            { q: "El gato ___ lame.", correct: "se", opts: ["se", "te", "me"] }
        ];

        const sorterData = [
            { t: "Me ba√±o", cat: "reflex" }, { t: "Nos besamos", cat: "recip" },
            { t: "Se ayudan", cat: "recip" }, { t: "Te vistes", cat: "reflex" },
            { t: "Os odi√°is", cat: "recip" }, { t: "Se afeita", cat: "reflex" },
            { t: "Nos vemos", cat: "recip" }, { t: "Me duermo", cat: "reflex" },
            { t: "Se divorcian", cat: "recip" }, { t: "Te lavas", cat: "reflex" },
            { t: "Se hablan", cat: "recip" }, { t: "Se peina", cat: "reflex" },
            { t: "Nos queremos", cat: "recip" }, { t: "Me acuesto", cat: "reflex" },
            { t: "Se golpean", cat: "recip" }
        ];

        const flashcardsData = [
            { es: "Ellos se dieron la mano.", en: "They shook hands." },
            { es: "Nos contamos secretos.", en: "We tell each other secrets." },
            { es: "Me miro al espejo.", en: "I look at myself in the mirror." },
            { es: "Juan y su hermano se pelean.", en: "Juan and his brother fight." },
            { es: "Los ni√±os se lavan las manos.", en: "The children wash their hands." },
            { es: "Mis abuelos se amaron.", en: "My grandparents loved each other." },
            { es: "¬øPor qu√© os grit√°is?", en: "Why do you shout at each other?" },
            { es: "Ella se puso el abrigo.", en: "She put on her coat." },
            { es: "Nos vimos en el parque.", en: "We saw each other at the park." },
            { es: "Tienes que cepillarte.", en: "You have to brush your teeth." }
        ];

        /* =========================================
           LOGIC & FUNCTIONS
           ========================================= */
        
        window.onload = function() {
            generateFloatingEmojis();
            loadPhrases();
            generateQuiz();
            generateStories();
            generateSorter();
            loadFlashcard(0);
        };

        // --- GLOBAL UI (TRANSLATION LOGIC MEJORADA) ---
        function toggleLang() {
            currentLang = currentLang === 'es' ? 'en' : 'es';
            
            // 1. Static Elements
            document.querySelectorAll('[data-key]').forEach(el => {
                const key = el.getAttribute('data-key');
                if(langData[currentLang][key]) {
                    el.innerHTML = langData[currentLang][key];
                }
            });

            // 2. Dynamic Elements Refresh
            loadPhrases(); // Recarga los botones "Explicar" en el nuevo idioma
            loadFlashcard(fcIndex); 

            // 3. NUEVO: Si el modal est√° abierto, actual√≠zalo en vivo
            const modal = document.getElementById('modal-global');
            if (modal.style.display === 'flex' && currentPhraseIndex !== null) {
                openPhraseModal(currentPhraseIndex);
            }
        }

        function toggleTheme() { document.body.classList.toggle('dark-mode'); }
        function switchTab(id) {
            document.querySelectorAll('.tab-content').forEach(d => d.classList.remove('active'));
            document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
            document.getElementById(id).classList.add('active');
            document.querySelector(`button[onclick="switchTab('${id}')"]`).classList.add('active');
        }

        function generateFloatingEmojis() {
            const emojis = ['ü™û', 'ü§ù', '‚ù§Ô∏è', 'üë•', 'üó£Ô∏è', 'üá™üá∏'];
            const container = document.getElementById('floating-bg');
            for(let i=0; i<20; i++) {
                let el = document.createElement('div');
                el.className = 'floater';
                el.innerText = emojis[Math.floor(Math.random() * emojis.length)];
                el.style.left = Math.random() * 100 + 'vw';
                el.style.animationDuration = (Math.random() * 15 + 15) + 's';
                el.style.animationDelay = (Math.random() * 10) + 's';
                container.appendChild(el);
            }
        }

        // --- BUILDER LOGIC ---
        function updateVisualizer(type) {
            const subj = document.getElementById('vis-subj');
            const pron = document.getElementById('vis-pron');
            const verb = document.getElementById('vis-verb');
            const clar = document.getElementById('vis-clar');
            pron.style.transform = 'scale(1)';
            setTimeout(() => {
                if (type === 'nosotros') {
                    subj.innerHTML = "Mi hermano y yo üë¶üë¶"; pron.innerHTML = "+ NOS +"; verb.innerHTML = "ayudamos üÜò"; clar.innerHTML = "(mutuamente)";
                } else if (type === 'vosotros') {
                    subj.innerHTML = "Vosotros (en Espa√±a) üá™üá∏"; pron.innerHTML = "+ OS +"; verb.innerHTML = "escrib√≠s ‚úâÔ∏è"; clar.innerHTML = "(el uno al otro)";
                } else if (type === 'ellos') {
                    subj.innerHTML = "Los perros üêïüêï"; pron.innerHTML = "+ SE +"; verb.innerHTML = "muerden ü¶∑"; clar.innerHTML = "(los unos a los otros)";
                }
                pron.style.transform = 'scale(1.2)';
                setTimeout(() => pron.style.transform = 'scale(1.1)', 300);
                speakPremium(subj.innerText + " " + pron.innerText.replace(/\+/g,'') + " " + verb.innerText);
            }, 100);
        }

        // --- PHRASES (MODAL MEJORADO) ---
        function loadPhrases() {
            const container = document.getElementById('phrases-container');
            container.innerHTML = '';
            phrasesData.forEach((p, index) => {
                let div = document.createElement('div');
                div.className = `phrase-card ${p.type === 'reflexive' ? 'reflexive' : (p.type === 'ambiguous' ? '' : 'reciprocal')}`;
                if(p.type === 'ambiguous') div.style.borderLeftColor = "#999";
                
                const btnText = langData[currentLang].explain;
                div.innerHTML = `
                    <div class="p-icon">${p.icon}</div>
                    <div class="p-text">${p.es}</div>
                    <div style="font-size:0.9rem; color:#666; text-align:center;">${p.en}</div>
                    <button class="p-btn" onclick="openPhraseModal(${index})">${btnText}</button>
                    <button class="btn" style="margin-top:5px; padding:5px 10px; font-size:0.8rem" onclick="speakPremium('${p.es}')">üîä</button>
                `;
                container.appendChild(div);
            });
        }

        function openPhraseModal(idx) {
            currentPhraseIndex = idx; // Guardar √≠ndice para traducci√≥n en vivo
            const p = phrasesData[idx];
            const isEs = currentLang === 'es';
            
            // Textos din√°micos seg√∫n idioma
            const title = isEs ? p.es.toUpperCase() : p.en.toUpperCase();
            const transLabel = langData[currentLang].trans_label;
            const typeLabel = langData[currentLang].type_label;
            const transText = isEs ? p.en : p.es;
            const typeText = langData[currentLang][p.type] || p.type.toUpperCase();
            const detailText = isEs ? p.detail : p.detail_en; // Elegir detalle correcto

            document.getElementById('m-header').innerText = title;
            document.getElementById('m-body').innerHTML = `
                <p><b>${transLabel}</b> ${transText}</p>
                <p><b>${typeLabel}</b> ${typeText}</p>
                <hr>
                <p style="font-size:1.1rem; line-height:1.6;">${detailText}</p>
            `;
            document.getElementById('modal-global').style.display = 'flex';
        }

        function closeModal(e) { 
            if(e.target.id === 'modal-global' || e.target.getAttribute('data-key') === 'close') {
                document.getElementById('modal-global').style.display = 'none';
                currentPhraseIndex = null; // Limpiar √≠ndice
            }
        }

        // --- GPS LOGIC ---
        function gpsNext(step, val) {
            document.querySelectorAll('.gps-step').forEach(el => el.classList.remove('active'));
            if(step===1 && val==='one') document.getElementById('gps-step-2a').classList.add('active');
            if(step===1 && val==='many') document.getElementById('gps-step-2b').classList.add('active');
            if(step===2 && val==='yes') document.getElementById('gps-result-rec').classList.add('active');
            if(step===2 && val==='no') document.getElementById('gps-result-refpl').classList.add('active');
        }
        function gpsReset() {
            document.querySelectorAll('.gps-step').forEach(el => el.classList.remove('active'));
            document.getElementById('gps-step-1').classList.add('active');
        }

        // --- PRACTICE ---
        function generateQuiz() {
            const c = document.getElementById('quiz-area');
            quizData.forEach((q, i) => {
                let opts = [...q.opts].sort(() => Math.random() - 0.5);
                let html = `<div class="quiz-question"><p><b>${i+1}.</b> ${q.q}</p><div class="quiz-options">`;
                opts.forEach(o => { html += `<button onclick="checkQuiz(this, '${o}', '${q.correct}')">${o}</button>`; });
                html += `</div></div>`;
                c.innerHTML += html;
            });
        }
        function checkQuiz(btn, val, correct) {
            const parent = btn.parentElement;
            const buttons = parent.querySelectorAll('button');
            buttons.forEach(b => b.disabled = true);
            if(val === correct) btn.classList.add('correct');
            else { btn.classList.add('wrong'); buttons.forEach(b => { if(b.innerText === correct) b.classList.add('correct'); }); }
        }

        function generateStories() {
            const stories = [
                "Juan y yo (nos/se) ___ escribimos.", "Ellos (se/nos) ___ miran.",
                "Ana y Luis (se/os) ___ aman.", "T√∫ (te/se) ___ lavas.",
                "Vosotros (os/se) ___ ayud√°is.", "El perro (se/me) ___ lame."
            ];
            const correctAnswers = ["nos", "se", "se", "te", "os", "se"];
            let html = '';
            stories.forEach((s, i) => {
                const parts = s.split('___');
                const opts = s.match(/\((.*?)\)/)[1].split('/');
                html += `<div class="story-container">${i+1}. ${parts[0].replace(/\(.*?\)/, '')} 
                    <select class="story-input" data-ans="${correctAnswers[i]}"><option value="?">?</option><option value="${opts[0]}">${opts[0]}</option><option value="${opts[1]}">${opts[1]}</option></select> ${parts[1]}</div>`;
            });
            document.getElementById('stories-area').innerHTML = html;
        }
        function checkStories() {
            document.querySelectorAll('.story-input').forEach(sel => {
                if(sel.value === sel.dataset.ans) sel.style.color = 'var(--green)'; else sel.style.color = 'var(--red)';
            });
        }

        function generateSorter() {
            const src = document.getElementById('sorter-source');
            sorterData.sort(() => Math.random() - 0.5).forEach((item, i) => {
                let el = document.createElement('div');
                el.className = 'drag-item'; el.draggable = true; el.innerText = item.t; el.id = 'd-'+i; el.dataset.cat = item.cat;
                el.ondragstart = (e) => { e.dataTransfer.setData("text", e.target.id); };
                src.appendChild(el);
            });
        }
        function allowDrop(ev) { ev.preventDefault(); }
        function drop(ev) {
            ev.preventDefault();
            var data = ev.dataTransfer.getData("text");
            var el = document.getElementById(data);
            if(ev.target.classList.contains('drop-zone')) ev.target.appendChild(el);
        }
        function checkSorter() {
            let correct = 0;
            document.getElementById('drop-reflex').querySelectorAll('.drag-item').forEach(el => {
                if(el.dataset.cat === 'reflex') { el.style.border = '2px solid var(--green)'; correct++; } else el.style.border = '2px solid var(--red)';
            });
            document.getElementById('drop-recip').querySelectorAll('.drag-item').forEach(el => {
                if(el.dataset.cat === 'recip') { el.style.border = '2px solid var(--green)'; correct++; } else el.style.border = '2px solid var(--red)';
            });
            alert(`Correctos: ${correct}/${sorterData.length}`);
        }

        // --- FLASHCARDS ---
        let fcIndex = 0;
        function loadFlashcard(idx) {
            const d = flashcardsData[idx];
            const frontText = currentLang === 'es' ? d.en : d.es;
            const backText = currentLang === 'es' ? d.es : d.en;

            document.getElementById('fc-front-text').innerText = frontText;
            document.getElementById('fc-back-text').innerText = backText;
            
            document.getElementById('fc-count').innerText = `${idx+1}/${flashcardsData.length}`;
            document.getElementById('fc-card-el').classList.remove('is-flipped');
        }
        function flipFlashcard() { document.getElementById('fc-card-el').classList.toggle('is-flipped'); }
        function nextFC() { fcIndex = (fcIndex+1)%flashcardsData.length; loadFlashcard(fcIndex); }
        function prevFC() { fcIndex = (fcIndex-1+flashcardsData.length)%flashcardsData.length; loadFlashcard(fcIndex); }
        function playCurrentCardAudio() { speakPremium(flashcardsData[fcIndex].es); }

    </script>
</body>
</html>
